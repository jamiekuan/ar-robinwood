<script>
  AFRAME.registerComponent("auto-switch-model", {
    init: function () {
      const model1 = document.querySelector("#model1-entity");
      const model2 = document.querySelector("#model2-entity");
      const text = document.querySelector("#dialogue-text");

      const dialogue = [
        "Congratulations!",
        "You've found all exhibitions today,",
        "but...",
        "I won't stop stealing staffs,",
        "as I'm Robinwood!"
      ];
      let currentLine = 0;

      const advanceDialogue = () => {
        if (currentLine < dialogue.length - 1) {
          currentLine++;
          text.setAttribute("value", dialogue[currentLine]);
        } else {
          model1.removeEventListener("click", advanceDialogue);
          model2.removeEventListener("click", advanceDialogue);
          text.removeEventListener("click", advanceDialogue);
        }
      };

      // åˆ‡æ›åˆ°ç¬¬äºŒå€‹æ¨¡å‹ä¸¦é‡å•Ÿå‹•ç•«
      const showModel2 = () => {
        model1.setAttribute("visible", false);
        model2.setAttribute("visible", true);
        
        // ğŸ”¥ é‡æ–°è§¸ç™¼ animation-mixerï¼Œç¢ºä¿å‹•ç•«æ’­æ”¾
        model2.removeAttribute("animation-mixer");
        model2.setAttribute("animation-mixer", "");
      };

      // é»æ“Šäº‹ä»¶
      model1.addEventListener("click", advanceDialogue);
      model2.addEventListener("click", advanceDialogue);
      text.addEventListener("click", advanceDialogue);

      // æ’­æ”¾å®Œç¬¬ä¸€å€‹æ¨¡å‹å‹•ç•«æ™‚åˆ‡æ›
      model1.addEventListener("animation-finished", showModel2);

      // å‚™æ¡ˆï¼š5 ç§’å¾Œå¼·åˆ¶åˆ‡æ›
      setTimeout(showModel2, 5000);
    },
  });

  document.querySelector("a-scene").setAttribute("auto-switch-model", "");
</script>
